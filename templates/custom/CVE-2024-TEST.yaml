id: CVE-2024-TEST

info:
  name: Test Template - All Extractors and Matchers
  author: test
  severity: high
  description: Test template to verify JSON, XPath, DSL extractors and matchers
  classification:
    cve-id: CVE-2024-TEST

variables:
  test_var: "test_value"

http:
  - method: GET
    path:
      - "{{BaseURL}}/api/test"

    matchers-condition: or
    matchers:
      # Status matcher
      - type: status
        status:
          - 200

      # Word matcher
      - type: word
        words:
          - "success"
          - "data"
        condition: and

      # Regex matcher
      - type: regex
        regex:
          - '"id":\s*\d+'

      # DSL matcher
      - type: dsl
        dsl:
          - "status_code == 200"
          - "len(body) > 0"
        condition: and

    extractors:
      # Regex extractor
      - type: regex
        name: version
        regex:
          - 'version":\s*"([^"]+)"'
        group: 1

      # JSON extractor
      - type: json
        name: user_id
        json:
          - '.user.id'

      # KVal extractor
      - type: kval
        name: content_type
        kval:
          - content_type

      # DSL extractor
      - type: dsl
        name: response_info
        dsl:
          - 'status_code + " - " + string(content_length)'
